<!DOCTYPE html>
<html>
<head>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      overflow: hidden;
    }
    
    #titlebar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 32px;
      background: #0f172a;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 10px;
      -webkit-app-region: drag;
      z-index: 999999;
      border-bottom: 1px solid #1e293b;
    }
    
    #titlebar-title {
      color: #94a3b8;
      font-size: 12px;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    #titlebar-controls {
      display: flex;
      -webkit-app-region: no-drag;
    }
    
    .titlebar-button {
      width: 46px;
      height: 32px;
      border: none;
      background: transparent;
      color: #94a3b8;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s;
    }
    
    .titlebar-button:hover {
      background: rgba(255, 255, 255, 0.1);
    }
    
    .titlebar-button.close:hover {
      background: #ef4444;
      color: white;
    }
    
    #app-content {
      margin-top: 32px;
      height: calc(100vh - 32px);
      width: 100vw;
    }
    
    #app-frame {
      width: 100%;
      height: 100%;
      border: none;
    }
    
    #update-notification {
      position: fixed;
      top: 40px;
      right: 10px;
      background: #1e293b;
      border: 1px solid #334155;
      border-radius: 8px;
      padding: 16px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
      z-index: 999998;
      min-width: 320px;
      animation: slideIn 0.3s ease-out;
    }
    
    @keyframes slideIn {
      from {
        transform: translateX(400px);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }
    
    #update-content {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    #update-icon {
      font-size: 32px;
      animation: rotate 2s linear infinite;
    }
    
    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    
    #update-text {
      flex: 1;
    }
    
    #update-title {
      color: white;
      font-weight: 600;
      font-size: 14px;
      margin-bottom: 4px;
    }
    
    #update-message {
      color: #94a3b8;
      font-size: 12px;
    }
    
    #update-actions {
      display: flex;
      gap: 8px;
    }
    
    .update-btn {
      padding: 6px 12px;
      border: none;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .update-btn.primary {
      background: #5865F2;
      color: white;
    }
    
    .update-btn.primary:hover {
      background: #4752C4;
    }
    
    .update-btn:not(.primary) {
      background: transparent;
      color: #94a3b8;
      border: 1px solid #334155;
    }
    
    .update-btn:not(.primary):hover {
      background: #334155;
      color: white;
    }
  </style>
</head>
<body>
  <div id="titlebar">
    <div id="titlebar-title">
      <svg width="24" height="24" viewBox="0 0 512 512" fill="#5865F2" style="filter: drop-shadow(0 0 2px rgba(88, 101, 242, 0.5));">
        <path d="M256 48c-79.5 0-144 64.5-144 144 0 27.9 7.9 53.9 21.6 76.1-8.2 24.1-21.6 52.3-21.6 76.9 0 44.2 35.8 80 80 80 17.7 0 34-5.8 47.2-15.6 11.4 1 23.1 1.6 35.2 1.6s23.8-.6 35.2-1.6c13.2 9.8 29.5 15.6 47.2 15.6 44.2 0 80-35.8 80-80 0-24.6-13.4-52.8-21.6-76.9 13.7-22.2 21.6-48.2 21.6-76.1 0-79.5-64.5-144-144-144zm-64 240c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 0c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"/>
      </svg>
      <span style="margin-left: 8px; font-weight: 600;">Collabrix</span>
    </div>
    <div id="titlebar-controls">
      <button class="titlebar-button" id="minimize" title="Minimize">
        <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
          <rect x="0" y="5" width="12" height="2"/>
        </svg>
      </button>
      <button class="titlebar-button" id="maximize" title="Maximize">
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" stroke="currentColor" stroke-width="1">
          <rect x="1" y="1" width="10" height="10"/>
        </svg>
      </button>
      <button class="titlebar-button close" id="close" title="Close">
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="M1 1 L11 11 M11 1 L1 11"/>
        </svg>
      </button>
    </div>
  </div>
  
  <div id="app-content">
    <iframe id="app-frame" src="https://collabrixs.vercel.app"></iframe>
  </div>
  
  <!-- Update notification -->
  <div id="update-notification" style="display: none;">
    <div id="update-content">
      <div id="update-icon">ðŸ”„</div>
      <div id="update-text">
        <div id="update-title">Update Available</div>
        <div id="update-message">A new version of Collabrix is available</div>
      </div>
      <div id="update-actions">
        <button id="update-download" class="update-btn primary">Download</button>
        <button id="update-dismiss" class="update-btn">Later</button>
      </div>
    </div>
  </div>
  
  <script>
    document.getElementById('minimize').addEventListener('click', () => {
      window.electronAPI.minimizeWindow();
    });
    
    document.getElementById('maximize').addEventListener('click', () => {
      window.electronAPI.maximizeWindow();
    });
    
    document.getElementById('close').addEventListener('click', () => {
      window.electronAPI.closeWindow();
    });
    
    // Update notification handlers
    let updateInfo = null;
    
    document.getElementById('update-download').addEventListener('click', () => {
      document.getElementById('update-message').textContent = 'Downloading update...';
      document.getElementById('update-download').disabled = true;
      window.electronAPI.downloadUpdate();
    });
    
    document.getElementById('update-dismiss').addEventListener('click', () => {
      document.getElementById('update-notification').style.display = 'none';
    });
    
    // Listen for update events from main process
    if (window.electronAPI && window.electronAPI.onUpdateAvailable) {
      window.electronAPI.onUpdateAvailable((info) => {
        updateInfo = info;
        document.getElementById('update-message').textContent = `Version ${info.version} is available`;
        document.getElementById('update-notification').style.display = 'block';
      });
      
      window.electronAPI.onUpdateDownloadProgress((progress) => {
        document.getElementById('update-message').textContent = `Downloading... ${Math.round(progress.percent)}%`;
      });
      
      window.electronAPI.onUpdateDownloaded((info) => {
        document.getElementById('update-icon').textContent = 'âœ…';
        document.getElementById('update-title').textContent = 'Update Ready';
        document.getElementById('update-message').textContent = 'Restart to install';
        document.getElementById('update-download').textContent = 'Restart Now';
        document.getElementById('update-download').disabled = false;
        document.getElementById('update-download').onclick = () => {
          window.electronAPI.installUpdate();
        };
      });
    }
  </script>
</body>
</html>
